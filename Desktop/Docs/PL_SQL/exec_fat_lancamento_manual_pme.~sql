select distinct 
       ce.num_contrato,
       'fat_lancamento_manual' || 
              '(p_cod_ts => '''', ' ||
              'p_cod_ts_contrato => ' || ce.cod_ts_contrato || ', ' ||
              'p_cod_entidade_ts => '''', ' ||
              'p_val_lancamento => '''', ' ||
              'p_txt_observacao => ''* Copart CNU PME'', ' ||
              'p_ind_debito_credito => ''D'', ' || 
              'p_cod_tipo_rubrica => 100, ' ||
              'p_mes_ano_ref => ''03/2021'', ' ||
              'p_cod_plano => '''', ' ||
              'p_cod_tipo_ciclo => 1, ' ||
              'p_num_lancamento_ts => '''', ' ||
              'p_ind_acao => ''I'', ' ||
              'p_cod_usuario => ''RAFAQUESI'', ' ||
              'p_txt_endereco_ip => '''', ' ||
              'p_ind_incide_ir => ''N'', ' ||
              'p_ind_incide_inss => ''N'', ' ||
              'p_num_contrato_fisico => '''', ' ||
              'p_cod_lotacao_ts => '''', ' ||
              'p_ind_erro_out => p_ind_erro_out, ' ||
              'p_msg_retorno_out => p_msg_retorno_out, ' ||
              'p_commit => ''S'', ' ||
              'p_versao => ''N'', ' ||
              'p_nom_anexo => ''''); '
from ts.contrato_empresa ce
where not exists (select 1 
                       from ts.lancamento_manual l
                       where l.cod_tipo_rubrica = 100
                             and l.cod_ts_contrato = ce.cod_ts_contrato
                             and l.mes_ano_ref = to_date('01/03/2021', 'dd/mm/yyyy'))
     and ce.num_contrato IN ('03289',
'04313',
'04777',
'04919',
'04938',
'04972',
'04973',
'05076',
'05087',
'05245',
'05249',
'05257',
'05398',
'05403',
'05493',
'05514',
'05546',
'05552',
'05578',
'05604',
'05608',
'05683',
'05701',
'06009',
'06019',
'06352',
'06440',
'06449',
'06460',
'06465',
'06530',
'06536',
'06539',
'06554',
'06645',
'06763',
'06826',
'06846',
'06867',
'06870',
'06874',
'06880',
'06882',
'06886',
'06918',
'06920',
'06923',
'06924',
'06933',
'06934',
'06941',
'06987',
'06994',
'07418',
'07419',
'07420',
'07426',
'07430',
'07766',
'07767',
'07768',
'07770',
'07778',
'07789',
'07791',
'07802',
'07804',
'07805',
'07875',
'07876',
'07884',
'08234',
'08282',
'08508',
'08825',
'08827',
'08890',
'08894',
'09149',
'09175',
'09179',
'09193',
'09246',
'09284',
'09338',
'09346',
'09358',
'09359',
'09391',
'09443',
'09444',
'09447',
'09462',
'09566',
'09611',
'09679',
'09684',
'09688',
'09695',
'09749',
'11168',
'12165',
'12178',
'12191',
'12212',
'12232',
'12260',
'12280',
'12371',
'12427',
'12444',
'12750',
'12755',
'12865',
'13081',
'13106',
'13135',
'13138',
'13154',
'13166',
'13243',
'13380',
'13383',
'13391',
'13480',
'13484',
'13639',
'13657',
'13679',
'13682',
'13741',
'13761',
'13771',
'13774',
'13781',
'13792',
'13804',
'13870',
'13874',
'13902',
'13920',
'13926',
'13941',
'13947',
'13948',
'14053',
'14054',
'14061',
'14071',
'14077',
'14117',
'14140',
'14143',
'14147',
'14148',
'14176',
'14182',
'14191',
'14203',
'14230',
'14237',
'14263',
'14280',
'14287',
'14335',
'14373',
'14397',
'14413',
'14415',
'14416',
'14419',
'14420',
'14421',
'14422',
'14423',
'14424',
'14428',
'14429',
'14430',
'14431',
'14516',
'14554',
'14576',
'14584',
'14588',
'14589',
'14616',
'14668',
'14679',
'14684',
'14685',
'14686',
'14687',
'14688',
'14690',
'14700',
'14711',
'14715',
'14716',
'14717',
'14718',
'14729',
'14777',
'14805',
'14809',
'14812',
'14827',
'15059',
'15062',
'15089',
'15208',
'15222',
'15364',
'15394',
'15395',
'15470',
'15474',
'15479',
'15498',
'15526',
'15530',
'15531',
'15601',
'15605',
'15608',
'15615',
'15698',
'15838',
'15884',
'15960',
'16002',
'16807',
'16843',
'16914',
'16918',
'17014',
'17035',
'17036',
'17063',
'17101',
'17117',
'17123',
'17128',
'17144',
'17149',
'17168',
'17176',
'17178',
'17194',
'17223',
'17288',
'17314',
'17345',
'17379',
'17465',
'17481',
'17504',
'17665',
'17713',
'17717',
'17718',
'17741',
'17745',
'17782',
'17893',
'17898',
'17923',
'17958',
'17995',
'17996',
'17997') 
ORDER BY 1
    
