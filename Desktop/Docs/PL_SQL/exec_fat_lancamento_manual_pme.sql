select distinct 
       ce.num_contrato,
       'fat_lancamento_manual' || 
              '(p_cod_ts => '''', ' ||
              'p_cod_ts_contrato => ' || ce.cod_ts_contrato || ', ' ||
              'p_cod_entidade_ts => '''', ' ||
              'p_val_lancamento => '''', ' ||
              'p_txt_observacao => ''Comp.12/2020'', ' ||
              'p_ind_debito_credito => ''D'', ' || 
              'p_cod_tipo_rubrica => 100, ' ||
              'p_mes_ano_ref => ''04/2021'', ' ||
              'p_cod_plano => '''', ' ||
              'p_cod_tipo_ciclo => 1, ' ||
              'p_num_lancamento_ts => '''', ' ||
              'p_ind_acao => ''I'', ' ||
              'p_cod_usuario => ''RAFAQUESI'', ' ||
              'p_txt_endereco_ip => '''', ' ||
              'p_ind_incide_ir => ''N'', ' ||
              'p_ind_incide_inss => ''N'', ' ||
              'p_num_contrato_fisico => '''', ' ||
              'p_cod_lotacao_ts => '''', ' ||
              'p_ind_erro_out => p_ind_erro_out, ' ||
              'p_msg_retorno_out => p_msg_retorno_out, ' ||
              'p_commit => ''S'', ' ||
              'p_versao => ''N'', ' ||
              'p_nom_anexo => ''''); '
from ts.contrato_empresa ce
where 
      not exists (select 1 
                       from ts.lancamento_manual l
                       where l.cod_tipo_rubrica = 100
                             and l.cod_ts_contrato = ce.cod_ts_contrato
                             and l.mes_ano_ref = to_date('01/04/2021', 'dd/mm/yyyy'))
     
     and
     ce.num_contrato IN ('04777',
'04919',
'04938',
'04972',
'04973',
'05072',
'05076',
'05076',
'05076',
'05076',
'05087',
'05249',
'05257',
'05273',
'05398',
'05403',
'05546',
'05552',
'05578',
'05604',
'05608',
'05904',
'06007',
'06019',
'06333',
'06352',
'06445',
'06449',
'06460',
'06460',
'06460',
'06460',
'06463',
'06465',
'06530',
'06536',
'06539',
'06540',
'06554',
'06645',
'06826',
'06846',
'06867',
'06870',
'06874',
'06880',
'06880',
'06882',
'06886',
'06918',
'06918',
'06920',
'06923',
'06924',
'06925',
'06934',
'06987',
'06995',
'07418',
'07419',
'07420',
'07422',
'07426',
'07766',
'07766',
'07767',
'07768',
'07769',
'07770',
'07770',
'07770',
'07770',
'07777',
'07789',
'07789',
'07791',
'07800',
'07802',
'07804',
'07805',
'07875',
'07876',
'07884',
'07994',
'08236',
'08252',
'08282',
'08508',
'08825',
'08827',
'08890',
'08894',
'09149',
'09175',
'09193',
'09246',
'09283',
'09338',
'09346',
'09355',
'09359',
'09411',
'09413',
'09443',
'09444',
'09458',
'09462',
'09609',
'09611',
'09684',
'09749',
'11168',
'11484',
'12165',
'12166',
'12178',
'12182',
'12191',
'12212',
'12260',
'12280',
'12304',
'12313',
'12336',
'12371',
'12427',
'12438',
'12444',
'12750',
'12755',
'12865',
'13081',
'13106',
'13135',
'13154',
'13165',
'13166',
'13243',
'13380',
'13401',
'13475',
'13480',
'13484',
'13634',
'13679',
'13680',
'13741',
'13761',
'13771',
'13774',
'13781',
'13792',
'13804',
'13877',
'13886',
'13902',
'13920',
'13926',
'13937',
'13941',
'13947',
'13948',
'14053',
'14054',
'14061',
'14071',
'14077',
'14117',
'14140',
'14143',
'14147',
'14147',
'14176',
'14182',
'14191',
'14203',
'14214',
'14230',
'14237',
'14242',
'14245',
'14263',
'14280',
'14280',
'14287',
'14333',
'14335',
'14335',
'14349',
'14353',
'14373',
'14382',
'14397',
'14397',
'14416',
'14416',
'14421',
'14422',
'14428',
'14429',
'14430',
'14460',
'14554',
'14576',
'14584',
'14588',
'14589',
'14604',
'14616',
'14628',
'14630',
'14668',
'14679',
'14684',
'14684',
'14685',
'14685',
'14685',
'14686',
'14687',
'14688',
'14688',
'14688',
'14690',
'14690',
'14700',
'14715',
'14716',
'14717',
'14718',
'14729',
'14730',
'14777',
'14805',
'14809',
'14812',
'14827',
'15059',
'15062',
'15089',
'15177',
'15198',
'15208',
'15222',
'15345',
'15350',
'15353',
'15364',
'15394',
'15466',
'15470',
'15472',
'15474',
'15476',
'15479',
'15498',
'15498',
'15499',
'15516',
'15526',
'15530',
'15557',
'15601',
'15605',
'15615',
'15704',
'15884',
'15896',
'15960',
'16002',
'16312',
'16807',
'16825',
'16863',
'16877',
'16913',
'16914',
'16914',
'16916',
'16918',
'16925',
'17029',
'17033',
'17036',
'17063',
'17067',
'17101',
'17110',
'17110',
'17123',
'17128',
'17149',
'17168',
'17194',
'17194',
'17194',
'17223',
'17224',
'17290',
'17312',
'17332',
'17345',
'17465',
'17504',
'17621',
'17645',
'17650',
'17665',
'17666',
'17718',
'17721',
'17727',
'17737',
'17741',
'17745',
'17745',
'17745',
'17746',
'17782',
'17869',
'17879',
'17898',
'17911',
'17923',
'17940',
'17944',
'17995',
'17996',
'17997',
'18061',
'18067',
'18073',
'18078',
'18146',
'18188',
'18271',
'18273',
'18273',
'18273',
'18298',
'18353',
'18365',
'18446',
'18469',
'18501',
'18506',
'19061',
'19194',
'19223',
'19288',
'19350',
'19352',
'19355',
'19370',
'19375',
'19542',
'19551',
'19552',
'19561',
'19570',
'19586',
'19597',
'19626',
'19682',
'19685',
'19695',
'19701',
'19701',
'19701',
'19767',
'19782',
'19882',
'19882') 
ORDER BY 1
    
