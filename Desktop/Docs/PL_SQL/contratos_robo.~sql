(select 'Cód. Contrato;Número Do Contrato;Nome Contrato;Código Na Operadora;Qtde Downloads;Operadora;Início Contrato;Fim Contrato;Download Robô'
from dual)
union all
(select c.cod_cont || ';' ||
       c.num_cont || ';' ||
       c.nome_cont || ';' ||
       c.cod_cont_for || ';' ||
       (select count(1)
          from alt_fin f
         where f.cod_tipo_cad_clifor = c.cod_tipo_cad_for
           and f.cod_cad_clifor = c.cod_cad_for
           and f.num_doc_fin = sys_get_number_fnc(c.cod_cont_for)) || ';' ||
       alt_get_fant_cad_fnc(2, c.cod_cad_for) || ';' ||
       to_char(c.dt_ini_cont, 'dd/mm/yyyy') || ';' ||
       to_char(c.dt_fim_cont, 'dd/mm/yyyy') || ';' ||
       decode(c.chk_down_robo_cont, -1, 'Sim', 0, 'Não')
			 
  from alt_cont c
where c.cod_cad_for IN (1, 3, 4, 5, 7, 11, 17, 54, 70, 97, 134, 231, 237)	--Operadoras específicas
      and c.chk_down_robo_cont = -1 -- Downloads 'SIM'
			and INSTR(c.cod_cont_for, '_') = 0 --Codigo do Contrato/Operadora sem o caractere _
			) 
 
